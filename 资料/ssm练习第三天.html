<!doctype html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<title>ssm练习第三天.md</title><link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css'><style type='text/css'>html, body {overflow-x: initial !important;}.CodeMirror { height: auto; }
.CodeMirror-scroll { overflow-y: hidden; overflow-x: auto; }
.CodeMirror-lines { padding: 4px 0px; }
.CodeMirror pre { }
.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler { background-color: white; }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); white-space: nowrap; background-color: rgb(247, 247, 247); }
.CodeMirror-linenumbers { }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.CodeMirror div.CodeMirror-cursor { border-left-width: 1px; border-left-style: solid; border-left-color: black; z-index: 3; }
.CodeMirror div.CodeMirror-secondarycursor { border-left-width: 1px; border-left-style: solid; border-left-color: silver; }
.CodeMirror.cm-keymap-fat-cursor div.CodeMirror-cursor { width: auto; border: 0px; z-index: 1; background: rgb(119, 238, 119); }
.CodeMirror div.CodeMirror-cursor.CodeMirror-overwrite { }
.cm-tab { display: inline-block; }
.cm-s-typora-default .cm-header, .cm-s-typora-default .cm-property { color: rgb(217, 79, 138); }
.cm-s-typora-default pre.cm-header1:not(.cm-atom) :not(.cm-overlay) { font-size: 2rem; line-height: 2rem; }
.cm-s-typora-default pre.cm-header2:not(.cm-atom) :not(.cm-overlay) { font-size: 1.4rem; line-height: 1.4rem; }
.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number { color: rgb(149, 132, 134); }
.cm-s-typora-default .cm-table-row, .cm-s-typora-default .cm-block-start { font-family: monospace; }
.cm-s-typora-default .cm-comment { color: rgb(74, 90, 159); font-family: monospace; }
.cm-s-typora-default .cm-tag { color: rgb(169, 68, 66); }
.cm-s-typora-default .cm-string { color: rgb(126, 134, 169); }
.cm-s-typora-default .cm-link { color: rgb(196, 122, 15); text-decoration: underline; }
.cm-s-typora-default .cm-variable-2, .cm-s-typora-default .cm-variable-1 { color: inherit; }
.cm-s-typora-default .cm-overlay { font-size: 1rem; font-family: monospace; }
.CodeMirror.cm-s-typora-default div.CodeMirror-cursor { border-left-width: 3px; border-left-style: solid; border-left-color: rgb(228, 98, 154); }
.cm-s-typora-default .CodeMirror-activeline-background { left: -60px; right: -30px; background: rgba(204, 204, 204, 0.2); }
.cm-s-typora-default .CodeMirror-gutters { border-right-style: none; background-color: inherit; }
.cm-s-typora-default .cm-trailing-space-new-line::after, .cm-startspace::after, .cm-starttab .cm-tab::after { content: "•"; position: absolute; left: 0px; opacity: 0; font-family: LetterGothicStd, monospace; }
.os-windows .cm-startspace::after, .os-windows .cm-starttab .cm-tab::after { left: -0.1em; }
.cm-starttab .cm-tab::after { content: " "; }
.cm-startspace, .cm-tab, .cm-starttab, .cm-trailing-space-a, .cm-trailing-space-b, .cm-trailing-space-new-line { font-family: monospace; position: relative; }
.cm-s-typora-default .cm-trailing-space-new-line::after { content: "↓"; opacity: 0.3; }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: black; }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-property { color: black; }
.cm-s-inner .cm-operator { color: black; }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: blue; }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: bold; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: rgb(255, 0, 0); }
.cm-invalidchar { color: rgb(255, 0, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.CodeMirror-activeline-background { background: rgb(232, 242, 255); }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { margin-bottom: -30px; margin-right: -30px; padding-bottom: 30px; padding-right: 30px; height: 100%; outline: none; position: relative; box-sizing: content-box; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow-x: hidden; overflow-y: scroll; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow-y: hidden; overflow-x: scroll; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; background: transparent; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right-width: 30px; border-right-style: solid; border-right-color: transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right-style: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-widget { }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right-style: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.CodeMirror-selected { background: rgb(217, 217, 217); }
.CodeMirror-focused .CodeMirror-selected { background: rgb(215, 212, 240); }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
.CodeMirror span { }
@media print { 
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


html { font-size: 14px; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1rem; line-height: 1.42857; color: rgb(51, 51, 51); overflow-x: hidden; background-color: rgb(255, 255, 255); }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: rgb(181, 214, 252); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; padding-bottom: 70px; white-space: pre-wrap; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export #write { margin: 0px auto; }
#write > p:first-child, #write > ul:first-child, #write > ol:first-child, #write > pre:first-child, #write > blockquote:first-child, #write > div:first-child, #write > table:first-child { margin-top: 30px; }
img { max-width: 100%; }
input, button, select, textarea { color: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
::before, ::after, * { box-sizing: border-box; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write div, #write pre { width: inherit; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6 { position: relative; }
h1 { font-size: 2rem; }
p { -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; }
.mathjax-block { margin-top: 0px; margin-bottom: 0px; -webkit-margin-before: 0rem; -webkit-margin-after: 0rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: bold; font-style: italic; }
a { cursor: pointer; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; margin: 4px 0px 0px; }
tr { page-break-inside: avoid; page-break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; page-break-inside: auto; }
table.md-table td { min-width: 80px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
pre { white-space: pre-wrap; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences, pre.md-fences { font-size: 0.9rem; display: block; page-break-inside: avoid; text-align: left; overflow: visible; white-space: pre; position: relative !important; background: inherit; }
.md-fences .CodeMirror.CodeMirror-wrap { top: -1.6em; margin-bottom: -1.6em; }
.md-fences.mock-cm { white-space: pre-wrap; }
.show-fences-line-number pre.md-fences { padding-left: 0px; }
.show-fences-line-number pre.md-fences.mock-cm { padding-left: 40px; }
.footnotes { color: rgb(136, 136, 136); font-size: 0.9rem; padding-top: 1em; padding-bottom: 1em; }
.footnotes + .footnotes { margin-top: -1em; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; text-decoration: none; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1rem; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: normal; text-align: left; box-sizing: content-box; direction: ltr; background: transparent; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li p, li .mathjax-block { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; }
@media print { 
  html, body { height: 100%; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  h1, h2, h3, h4, h5, h6 { page-break-after: avoid; orphans: 2; }
  p { orphans: 4; }
  @page { margin: 20mm 0mm; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
#write pre.md-meta-block { font-size: 0.8rem; min-height: 2.86rem; white-space: pre-wrap; display: block; background: rgb(204, 204, 204); }
p > .md-image:only-child { display: inline-block; width: 100%; text-align: center; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.mathjax-block { white-space: pre; overflow: hidden; width: 100%; }
p + .mathjax-block { margin-top: -1.143rem; }
.mathjax-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus { outline: none; box-shadow: none; }
.task-list { list-style-type: none; }
.task-list-item { position: relative; padding-left: 1em; }
.task-list-item input { position: absolute; top: 0px; left: 0px; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc::after, .md-toc-content::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: bold; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
.md-toc-h6 { margin-left: 12em; }
@media screen and (max-width: 48em) { 
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 8em; }
  .md-toc-h6 { margin-left: 9.5em; }
}
a.md-toc-inner { color: inherit; font-size: inherit; font-style: inherit; font-weight: inherit; text-decoration: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
.md-tag { opacity: 0.5; }
code { text-align: left; }
h1 .md-tag, h2 .md-tag, h3 .md-tag, h4 .md-tag, h5 .md-tag, h6 .md-tag { font-weight: initial; opacity: 0.35; }
a.md-header-anchor.md-print-anchor { border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: none !important; text-decoration: initial !important; text-shadow: initial !important; background: transparent !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.mathjax-block .MathJax_SVG_Display { text-align: center; margin: 1em 0em; position: relative; text-indent: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; width: 100%; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: monospace; }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }


@font-face { font-family: 'Open Sans'; font-style: normal; font-weight: normal; src: local(Open Sans Regular), url(file:///C:/Users/Administrator/AppData/Roaming/Typora/themes/github/400.woff) format(woff); }
@font-face { font-family: 'Open Sans'; font-style: italic; font-weight: normal; src: local(Open Sans Italic), url(file:///C:/Users/Administrator/AppData/Roaming/Typora/themes/github/400i.woff) format(woff); }
@font-face { font-family: 'Open Sans'; font-style: normal; font-weight: bold; src: local(Open Sans Bold), url(file:///C:/Users/Administrator/AppData/Roaming/Typora/themes/github/700.woff) format(woff); }
@font-face { font-family: 'Open Sans'; font-style: italic; font-weight: bold; src: local(Open Sans Bold Italic), url(file:///C:/Users/Administrator/AppData/Roaming/Typora/themes/github/700i.woff) format(woff); }
html { font-size: 16px; }
body { font-family: 'Open Sans', 'Clear Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif; color: rgb(51, 51, 51); line-height: 1.6; -webkit-font-smoothing: antialiased; }
#write { max-width: 800px; margin: 0px auto; padding: 20px 30px 40px; }
#write::after { height: 80px; }
#write > ul:first-child, #write > ol:first-child { margin-top: 30px; }
body > :first-child { margin-top: 0px !important; }
body > :last-child { margin-bottom: 0px !important; }
a { color: rgb(65, 131, 196); }
h1, h2, h3, h4, h5, h6 { position: relative; margin-top: 1rem; margin-bottom: 1rem; font-weight: bold; line-height: 1.4; -webkit-font-smoothing: antialiased; cursor: text; }
h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor { text-decoration: none; }
h1 tt, h1 code { font-size: inherit; }
h2 tt, h2 code { font-size: inherit; }
h3 tt, h3 code { font-size: inherit; }
h4 tt, h4 code { font-size: inherit; }
h5 tt, h5 code { font-size: inherit; }
h6 tt, h6 code { font-size: inherit; }
h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
h3 { font-size: 1.5em; line-height: 1.43; }
h4 { font-size: 1.25em; }
h5 { font-size: 1em; }
h6 { font-size: 1em; color: rgb(119, 119, 119); }
p, blockquote, ul, ol, dl, table { margin: 0.8em 0px; }
li > ol, li > ul { margin: 0px; }
hr { height: 4px; padding: 0px; margin: 16px 0px; border-width: 0px 0px 1px; border-style: none none solid; overflow: hidden; box-sizing: content-box; border-bottom-color: rgb(221, 221, 221); background-color: rgb(231, 231, 231); }
body > h2:first-child { margin-top: 0px; padding-top: 0px; }
body > h1:first-child { margin-top: 0px; padding-top: 0px; }
body > h1:first-child + h2 { margin-top: 0px; padding-top: 0px; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child { margin-top: 0px; padding-top: 0px; }
a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 { margin-top: 0px; padding-top: 0px; }
h1 p, h2 p, h3 p, h4 p, h5 p, h6 p { margin-top: 0px; }
li p.first { display: inline-block; }
ul, ol { padding-left: 30px; }
ul:first-child, ol:first-child { margin-top: 0px; }
ul:last-child, ol:last-child { margin-bottom: 0px; }
blockquote { border-left-width: 4px; border-left-style: solid; border-left-color: rgb(221, 221, 221); padding: 0px 15px; color: rgb(119, 119, 119); }
blockquote blockquote { padding-right: 0px; }
table { padding: 0px; }
table tr { border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); margin: 0px; padding: 0px; background-color: white; }
table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
table tr th { font-weight: bold; border: 1px solid rgb(204, 204, 204); text-align: left; margin: 0px; padding: 6px 13px; }
table tr td { border: 1px solid rgb(204, 204, 204); text-align: left; margin: 0px; padding: 6px 13px; }
table tr th:first-child, table tr td:first-child { margin-top: 0px; }
table tr th:last-child, table tr td:last-child { margin-bottom: 0px; }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); }
pre.md-fences, .md-fences, code, tt { border: 1px solid rgb(221, 221, 221); border-radius: 3px; font-family: Consolas, 'Liberation Mono', Courier, monospace; padding: 2px 4px 0px; font-size: 0.9em; background-color: rgb(248, 248, 248); }
pre.md-fences, .md-fences { margin-bottom: 15px; margin-top: 15px; padding: 8px 1em 6px; }
.task-list { padding-left: 0px; }
.task-list-item { padding-left: 32px; }
.task-list-item input { top: 3px; left: 8px; }
@media screen and (min-width: 914px) { 
}
@media print { 
  table, pre { page-break-inside: avoid; }
  pre { word-wrap: break-word; }
}
.md-fences { background-color: rgb(248, 248, 248); }
#write pre.md-meta-block { padding: 1rem; font-size: 85%; line-height: 1.45; border: 0px; border-radius: 3px; color: rgb(119, 119, 119); margin-top: 0px !important; background-color: rgb(247, 247, 247); }
.mathjax-block > .code-tooltip { bottom: 0.375rem; }
#write > h3.md-focus::before { left: -1.5625rem; top: 0.375rem; }
#write > h4.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h5.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h6.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
.md-image > .md-meta { border: 1px solid rgb(221, 221, 221); border-radius: 3px; font-family: Consolas, 'Liberation Mono', Courier, monospace; padding: 2px 4px 0px; font-size: 0.9em; color: inherit; background-color: rgb(248, 248, 248); }
.md-tag { color: inherit; }
.md-toc { margin-top: 20px; padding-bottom: 20px; }
#typora-quick-open { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); }
#typora-quick-open-item { border-color: rgb(254, 254, 254) rgb(229, 229, 229) rgb(229, 229, 229) rgb(238, 238, 238); border-style: solid; border-width: 1px; background-color: rgb(250, 250, 250); }


</style>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-node'><h1><a name='header-c1' class='md-header-anchor '></a>SSM练习 第3天</h1><h2><a name='header-c6' class='md-header-anchor '></a>课程大纲</h2><ol><li>分页回顾</li><li>学习分页插件PageHelper的使用</li><li>使用PageHelper实现产品列表分页查询</li><li>SpringSecurity学习</li><li>项目中集成SpringSecurity</li><li>实现用户登录认证</li></ol><pre class='md-fences mock-cm' style='display:block;position:relative'>	重点：
		分页插件要能在项目中使用，能使用SpringSecurity在项目中实现用户拦截配置</pre><h3><a name='header-c27' class='md-header-anchor '></a>第1章 分页回顾</h3><h4><a name='header-c28' class='md-header-anchor '></a>1.1 Oracle中分页的实现</h4><h5><a name='header-c29' class='md-header-anchor '></a>1.1.1 Oracle中不带排序的分页</h5><pre class='md-fences mock-cm' style='display:block;position:relative'>select * from
  (
    select rownum rn,p.* from product p
  ) rp 
where 
  rp.rn between 1 and 3;</pre><h5><a name='header-c31' class='md-header-anchor '></a>1.1.2 Oracle中带排序的分页</h5><pre class='md-fences mock-cm' style='display:block;position:relative'>--把rn作为分页的条件
select * from
  (  
     --在排序结果中再次查询，把rownum作为结果集的一列
     select rownum rn,p.* from
       (
           --查询同时实现排序
           select * from product order by productprice desc
        ) p
  ) 
  where 
        rn between 1 and 3;</pre><h5><a name='header-c33' class='md-header-anchor '></a>1.1.3 分析</h5><p>从上面2个分页语句来看，我们每次只需要传入between后面的2个参数即可实现分页查询。我们看看下面的分页图片，前台每次传过来的参数有每页显示5(size)条数据和当前页是第几页(page)，根据这2参数，我们可以获得between后面2个参数的计算公式：</p><pre class='md-fences mock-cm' style='display:block;position:relative'>between 1 and 3
每页显示条数：size
当前页：page
1=(page-1)*size+1;
3=page*size;</pre><p><img src='img\图片01.png' alt='' /></p><h4><a name='header-c40' class='md-header-anchor '></a>1.2 实现产品列表分页查询</h4><h5><a name='header-c41' class='md-header-anchor '></a>1.2.1 分页工具类的封装</h5><p>通过上面的图片，我们可以看到，每次都有对应的分页信息需要现实，我们可以讲对应的分页信息封装起来，封装代码如下：</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure">AخA</div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">PageBean</span><span class="cm-operator">&lt;</span><span class="cm-variable">T</span><span class="cm-operator">&gt;</span> {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">// 当前页，手动添加的默认值是1</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">private</span> <span class="cm-variable-3">int</span> <span class="cm-variable">pageCode</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">// 总页数</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">// private int totalPage;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">// 总记录数</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">private</span> <span class="cm-variable-3">int</span> <span class="cm-variable">totalCount</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">// 每页显示的记录条数，每页显示5条</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">private</span> <span class="cm-variable-3">int</span> <span class="cm-variable">pageSize</span> <span class="cm-operator">=</span> <span class="cm-number">5</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">// 每页显示的数据</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">private</span> <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">T</span><span class="cm-operator">&gt;</span> <span class="cm-variable">beanList</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">public</span> <span class="cm-variable-3">int</span> <span class="cm-variable">getPageCode</span>() {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">return</span> <span class="cm-variable">pageCode</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">public</span> <span class="cm-variable-3">void</span> <span class="cm-variable">setPageCode</span>(<span class="cm-variable-3">int</span> <span class="cm-variable">pageCode</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">this</span>.<span class="cm-variable">pageCode</span> <span class="cm-operator">=</span> <span class="cm-variable">pageCode</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">/**</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span> <span class="cm-comment">* 调用getTotalPage() 获取到总页数</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span> <span class="cm-comment">* JavaBean的属性规定：totalPage是JavaBean是属性 ${pageBean.totalPage}</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span> <span class="cm-comment">* @return</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span> <span class="cm-comment">*/</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">public</span> <span class="cm-variable-3">int</span> <span class="cm-variable">getTotalPage</span>() {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">// 计算</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-variable-3">int</span> <span class="cm-variable">totalPage</span> <span class="cm-operator">=</span> <span class="cm-variable">totalCount</span> <span class="cm-operator">/</span> <span class="cm-variable">pageSize</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">// 说明整除</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">if</span>(<span class="cm-variable">totalCount</span> <span class="cm-operator">%</span> <span class="cm-variable">pageSize</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">return</span> <span class="cm-variable">totalPage</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span>}<span class="cm-keyword">else</span>{</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">return</span> <span class="cm-variable">totalPage</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">/*public void setTotalPage(int totalPage) {</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">this.totalPage = totalPage;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">}*/</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">public</span> <span class="cm-variable-3">int</span> <span class="cm-variable">getTotalCount</span>() {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">return</span> <span class="cm-variable">totalCount</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">public</span> <span class="cm-variable-3">void</span> <span class="cm-variable">setTotalCount</span>(<span class="cm-variable-3">int</span> <span class="cm-variable">totalCount</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">this</span>.<span class="cm-variable">totalCount</span> <span class="cm-operator">=</span> <span class="cm-variable">totalCount</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">public</span> <span class="cm-variable-3">int</span> <span class="cm-variable">getPageSize</span>() {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">return</span> <span class="cm-variable">pageSize</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">public</span> <span class="cm-variable-3">void</span> <span class="cm-variable">setPageSize</span>(<span class="cm-variable-3">int</span> <span class="cm-variable">pageSize</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">this</span>.<span class="cm-variable">pageSize</span> <span class="cm-operator">=</span> <span class="cm-variable">pageSize</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">public</span> <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">T</span><span class="cm-operator">&gt;</span> <span class="cm-variable">getBeanList</span>() {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">return</span> <span class="cm-variable">beanList</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-keyword">public</span> <span class="cm-variable-3">void</span> <span class="cm-variable">setBeanList</span>(<span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">T</span><span class="cm-operator">&gt;</span> <span class="cm-variable">beanList</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-keyword">this</span>.<span class="cm-variable">beanList</span> <span class="cm-operator">=</span> <span class="cm-variable">beanList</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>}</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div></div></pre><h5><a name='header-c45' class='md-header-anchor '></a>1.2.2 Controller代码实现</h5><p>根据上面的分析，前台需要向后台传递2个参数，分别是每页显示多少条(size)和当前页(page)，一般我们在查询列表页的时候，第一次请求不会加分页参数，所以应该要给他们默认参数，首次请求列表页，我们可以让size=5，page=1，这也符合工作中的现实要求。</p><p>修改ProductController，将列表查询的方法做如下改造：</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">/***</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* 商品列表查询（分页回顾）</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* @param model</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* @return</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">*/</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">@RequestMapping</span>(<span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-string">"/list"</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-variable-3">String</span> <span class="cm-def">list</span>(<span class="cm-meta">@RequestParam</span>(<span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-string">"page"</span>,<span class="cm-variable">required</span> <span class="cm-operator">=</span> <span class="cm-atom">false</span>,<span class="cm-variable">defaultValue</span> <span class="cm-operator">=</span> <span class="cm-string">"1"</span>)<span class="cm-variable-3">int</span> <span class="cm-variable">page</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-meta">@RequestParam</span>(<span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-string">"size"</span>,<span class="cm-variable">required</span> <span class="cm-operator">=</span> <span class="cm-atom">false</span>,<span class="cm-variable">defaultValue</span> <span class="cm-operator">=</span> <span class="cm-string">"5"</span>)<span class="cm-variable-3">int</span> <span class="cm-variable">size</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Model</span> <span class="cm-variable">model</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//集合查询</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">PageBean</span><span class="cm-operator">&lt;</span><span class="cm-variable">Product</span><span class="cm-operator">&gt;</span> <span class="cm-variable">pageInfo</span> <span class="cm-operator">=</span> <span class="cm-variable">productService</span>.<span class="cm-variable">pageList</span>(<span class="cm-variable">page</span>,<span class="cm-variable">size</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//将数据存入到Model中</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">model</span>.<span class="cm-variable">addAttribute</span>(<span class="cm-string">"pageInfo"</span>,<span class="cm-variable">pageInfo</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">return</span> <span class="cm-string">"product-list"</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div></div></pre><h5><a name='header-c51' class='md-header-anchor '></a>1.2.3 Service代码实现</h5><p>修改ProductService接口</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">//接口</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">PageBean</span><span class="cm-operator">&lt;</span><span class="cm-variable">Product</span><span class="cm-operator">&gt;</span> <span class="cm-def">pageList</span>(<span class="cm-variable-3">int</span> <span class="cm-variable">page</span>, <span class="cm-variable-3">int</span> <span class="cm-variable">size</span>);</span></pre></div></div></div></div></div></div></div></pre><p>修改ProductServiceImpl实现类</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">/***</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* 产品分页查询</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* @param page</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* @param size</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* @return</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">*/</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-meta">@Override</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-keyword">public</span> <span class="cm-variable">PageBean</span><span class="cm-operator">&lt;</span><span class="cm-variable">Product</span><span class="cm-operator">&gt;</span> <span class="cm-def">pageList</span>(<span class="cm-variable-3">int</span> <span class="cm-variable">page</span>, <span class="cm-variable-3">int</span> <span class="cm-variable">size</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">if</span> (<span class="cm-variable">page</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">page</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-comment">//查询 总记录数数</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable-3">int</span> <span class="cm-variable">total</span> <span class="cm-operator">=</span><span class="cm-variable">productDao</span>.<span class="cm-variable">findCount</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">PageBean</span><span class="cm-operator">&lt;</span><span class="cm-variable">Product</span><span class="cm-operator">&gt;</span> <span class="cm-variable">pageBean</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">PageBean</span><span class="cm-operator">&lt;&gt;</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">pageBean</span>.<span class="cm-variable">setTotalCount</span>(<span class="cm-variable">total</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">pageBean</span>.<span class="cm-variable">setPageSize</span>(<span class="cm-variable">size</span>);<span class="cm-comment">//设置每页显示记录数</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">if</span> (<span class="cm-variable">page</span> <span class="cm-operator">&gt;</span> <span class="cm-variable">pageBean</span>.<span class="cm-variable">getTotalPage</span>()){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">page</span> <span class="cm-operator">=</span> <span class="cm-variable">pageBean</span>.<span class="cm-variable">getTotalPage</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">pageBean</span>.<span class="cm-variable">setPageCode</span>(<span class="cm-variable">page</span>);<span class="cm-comment">//当前页码</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-comment">//查询当前页码</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-comment">//int page ==&gt;从哪一行开始查询 &nbsp;  1=(page-1)*size+1;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-comment">//int size ==&gt;结束查询 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  3=page*size;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">Product</span><span class="cm-operator">&gt;</span> <span class="cm-variable">productList</span> <span class="cm-operator">=</span> <span class="cm-variable">productDao</span>.<span class="cm-variable">findPageList</span>((<span class="cm-variable">page</span><span class="cm-operator">-</span><span class="cm-number">1</span>)<span class="cm-operator">*</span><span class="cm-variable">size</span><span class="cm-operator">+</span><span class="cm-number">1</span>,<span class="cm-variable">page</span><span class="cm-operator">*</span><span class="cm-variable">size</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">pageBean</span>.<span class="cm-variable">setBeanList</span>(<span class="cm-variable">productList</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-keyword">return</span> <span class="cm-variable">pageBean</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> }</span></pre></div></div></div></div></div></div></div></pre><h5><a name='header-c58' class='md-header-anchor '></a>1.2.4 Dao代码实现</h5><p>修改ProductDao,由于我们之前传递的入参是一个JavaBean对象，所以可以直接用#{属性名}来取对应SQL语句占位符的参数，但是如果入参是多个基本数据类型或者多个String类型，我们就无法像之前那么去取，我们可以使用一个注解来实现参数别名的标记@Param(value=&quot;别名&quot;),用@Param之后，SQL语句就可以直接取@Param(value=&quot;name&quot;)中的name了。</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">/***</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* 分页查询</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* 我们这里采用了不使用排序的分页方式</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* @return</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* @param start</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* @param end</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">*/</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">@Select</span>(<span class="cm-string">"select * from(select rownum rn,p.* from product p) rp where rp.rn between #{start} and #{end}"</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">Product</span><span class="cm-operator">&gt;</span> <span class="cm-def">findPageList</span>(<span class="cm-meta">@Param</span>(<span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-string">"start"</span>)<span class="cm-variable-3">int</span> <span class="cm-variable">start</span>, <span class="cm-meta">@Param</span>(<span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-string">"end"</span>)<span class="cm-variable-3">int</span> <span class="cm-variable">end</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">/***</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* 查询总记录数</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">* @return</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-comment">*/</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">@Select</span>(<span class="cm-string">"select count(*) from product"</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable-3">int</span> <span class="cm-def">findCount</span>();</span></pre></div></div></div></div></div></div></div></pre><h5><a name='header-c62' class='md-header-anchor '></a>1.2.5 product-list.jsp改造</h5><p>将c:forEach中的items所取的迭代对象换成pageInfo.beanList，其他不变。</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;tbody&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag">&lt;c:forEach</span> <span class="cm-attribute">items</span>=<span class="cm-string">"${pageInfo.beanList}"</span> <span class="cm-attribute">var</span>=<span class="cm-string">"product"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tag">&lt;tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tag">&lt;td&gt;&lt;input</span> <span class="cm-attribute">name</span>=<span class="cm-string">"ids"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"${product.id}"</span> <span class="cm-attribute">type</span>=<span class="cm-string">"checkbox"</span><span class="cm-tag">&gt;&lt;/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span>//...略</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tag">&lt;/tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag">&lt;/c:forEach&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/tbody&gt;</span></span></pre></div></div></div></div></div></div></div></pre><p>分页数据填充</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"box-footer"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"pull-left"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"form-group form-inline"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  总共${pageInfo.totalPage} 页，${pageInfo.totalCount} 条数据。 每页</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;select</span> <span class="cm-attribute">class</span>=<span class="cm-string">"form-control"</span> <span class="cm-attribute">onchange</span>=<span class="cm-string">"changePageSize(this)"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;option</span> <span class="cm-attribute">selected</span>=<span class="cm-string">"selected"</span><span class="cm-tag">&gt;</span>5<span class="cm-tag">&lt;/option&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;option</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-error">&lt;c:if test="${pageInfo.pageSize == 10}"&gt;selected</span><span class="cm-tag cm-error">&lt;/c:if&gt;</span> &gt;10</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag cm-error">&lt;/option&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag cm-error">&lt;/select&gt;</span> 条</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tag">&lt;/div&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag cm-error">&lt;/div&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"box-tools pull-right"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;ul</span> <span class="cm-attribute">class</span>=<span class="cm-string">"pagination"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"/product/list?page=1&amp;size=${pageInfo.pageSize}"</span> <span class="cm-attribute">aria-label</span>=<span class="cm-string">"Previous"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  首页<span class="cm-tab">  </span><span class="cm-tab">    </span><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"/product/list?page=${pageInfo.pageCode-1}&amp;size=${pageInfo.pageSize}"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  上一页<span class="cm-tab"> </span><span class="cm-tab">    </span><span class="cm-tab">    </span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;c:forEach</span> <span class="cm-attribute">begin</span>=<span class="cm-string">"1"</span> <span class="cm-attribute">end</span>=<span class="cm-string">"${pageInfo.totalPage}"</span> <span class="cm-attribute">var</span>=<span class="cm-string">"i"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"/product/list?page=${i}&amp;size=${pageInfo.pageSize}"</span><span class="cm-tag">&gt;</span>${i}<span class="cm-tag">&lt;/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/c:forEach&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"/product/list?page=${pageInfo.pageCode+1}&amp;size=${pageInfo.pageSize}"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  下一页</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"/product/list?page=${pageInfo.totalPage}&amp;size=${pageInfo.pageSize}"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-attribute">aria-label</span>=<span class="cm-string">"Next"</span><span class="cm-tag">&gt;</span>尾页<span class="cm-tag">&lt;/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/ul&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/div&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-error">&lt;/div&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">...</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  function changePageSize(who) {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  //拼接一个请求地址</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  var url = '/product/list?size='+who.value;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  //请求地址</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  location.href=url;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;">...</span></pre></div></div></div></div></div></div></div></pre><h3><a name='header-c69' class='md-header-anchor '></a>第2章 分页插件PageHelper</h3><h4><a name='header-c70' class='md-header-anchor '></a>2.1 PageHelper的介绍</h4><p>PageHelper是国内非常优秀的一款开源的mybatis分页插件，它支持基本主流与常用的数据库，例如mysql、oracle、mariaDB、DB2、SQLite、Hsqldb等。</p><pre class='md-fences mock-cm' style='display:block;position:relative'>网址：https://pagehelper.github.io/
本项目在 github 的项目地址：https://github.com/pagehelper/Mybatis-PageHelper
本项目在 gitosc 的项目地址：http://git.oschina.net/free/Mybatis_PageHelper
分页插件学习文档：https://pagehelper.github.io/docs/howtouse/</pre><h4><a name='header-c74' class='md-header-anchor '></a>2.2 PageHelper集成到项目中</h4><p>引入分页插件有下面2种方式，推荐使用 Maven 方式。</p><h5><a name='header-c77' class='md-header-anchor '></a>2.2.1 引入jar包方式</h5><pre class='md-fences mock-cm' style='display:block;position:relative'>你可以从下面的地址中下载最新版本的 jar 包
https://oss.sonatype.org/content/repositories/releases/com/github/pagehelper/pagehelper/
http://repo1.maven.org/maven2/com/github/pagehelper/pagehelper/

由于使用了sql 解析工具，你还需要下载 jsqlparser.jar：
http://repo1.maven.org/maven2/com/github/jsqlparser/jsqlparser/0.9.5/</pre><h5><a name='header-c79' class='md-header-anchor '></a>2.2.2 Maven方式</h5><pre class='md-fences mock-cm' style='display:block;position:relative'>  &lt;!--分页插件--&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;
    &lt;artifactId&gt;pagehelper&lt;/artifactId&gt;
    &lt;version&gt;最新版本&lt;/version&gt;
  &lt;/dependency&gt;</pre><h5><a name='header-c81' class='md-header-anchor '></a>2.2.4 配置PageHelper</h5><p>特别注意，新版拦截器是 com.github.pagehelper.PageInterceptor。 com.github.pagehelper.PageHelper 现在是一个特殊的 dialect 实现类，是分页插件的默认实现类，提供了和以前相同的用法。</p><h5><a name='header-c84' class='md-header-anchor '></a>2.2.4.1 在 MyBatis 配置 xml 中配置拦截器插件</h5><pre class='md-fences mock-cm' style='display:block;position:relative'>&lt;!-- 
    plugins在配置文件中的位置必须符合要求，否则会报错，顺序如下:
    properties?, settings?, 
    typeAliases?, typeHandlers?, 
    objectFactory?,objectWrapperFactory?, 
    plugins?, 
    environments?, databaseIdProvider?, mappers?
--&gt;
&lt;plugins&gt;
    &lt;!-- com.github.pagehelper为PageHelper类所在包名 --&gt;
    &lt;plugin interceptor=&quot;com.github.pagehelper.PageInterceptor&quot;&gt;
        &lt;!-- 使用下面的方式配置参数，后面会有所有的参数介绍 --&gt;
        &lt;property name=&quot;param1&quot; value=&quot;value1&quot;/&gt;
	&lt;/plugin&gt;
&lt;/plugins&gt;</pre><h5><a name='header-c86' class='md-header-anchor '></a>2.2.4.2 在 Spring 配置文件中配置拦截器插件</h5><p>使用 spring 的属性配置方式，可以使用 plugins 属性像下面这样配置：</p><pre class='md-fences mock-cm' style='display:block;position:relative'>&lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
  &lt;!-- 注意其他配置 --&gt;
  &lt;property name=&quot;plugins&quot;&gt;
    &lt;array&gt;
      &lt;bean class=&quot;com.github.pagehelper.PageInterceptor&quot;&gt;
        &lt;property name=&quot;properties&quot;&gt;
          &lt;!--使用下面的方式配置参数，一行配置一个 --&gt;
          &lt;value&gt;
            params=value1
          &lt;/value&gt;
        &lt;/property&gt;
      &lt;/bean&gt;
    &lt;/array&gt;
  &lt;/property&gt;
&lt;/bean&gt;</pre><h5><a name='header-c90' class='md-header-anchor '></a>2.2.4.3 分页插件参数介绍</h5><ol><li><p>helperDialect：分页插件会自动检测当前的数据库链接，自动选择合适的分页方式。 你可以配置helperDialect属性来指定分页插件使用哪种方言。配置时，可以使用下面的缩写值：
oracle,mysql,mariadb,sqlite,hsqldb,postgresql,db2,sqlserver,informix,h2,sqlserver2012,derby</p><p>特别注意：使用 SqlServer2012 数据库时，需要手动指定为 sqlserver2012，否则会使用 SqlServer2005 的方式进行分页。
你也可以实现 AbstractHelperDialect，然后配置该属性为实现类的全限定名称即可使用自定义的实现方法。</p></li><li><p>offsetAsPageNum：默认值为 false，该参数对使用 RowBounds 作为分页参数时有效。 当该参数设置为 true 时，会将 RowBounds 中的 offset 参数当成 pageNum 使用，可以用页码和页面大小两个参数进行分页。</p></li><li><p>rowBoundsWithCount：默认值为false，该参数对使用 RowBounds 作为分页参数时有效。 当该参数设置为true时，使用 RowBounds 分页会进行 count 查询。</p></li><li><p>pageSizeZero：默认值为 false，当该参数设置为 true 时，如果 pageSize=0 或者 RowBounds.limit = 0 就会查询出全部的结果（相当于没有执行分页查询，但是返回结果仍然是 Page 类型）。</p></li><li><p>reasonable：分页合理化参数，默认值为false。当该参数设置为 true 时，pageNum&lt;=0 时会查询第一页， pageNum&gt;pages（超过总数时），会查询最后一页。默认false 时，直接根据参数进行查询。</p></li><li><p>params：为了支持startPage(Object params)方法，增加了该参数来配置参数映射，用于从对象中根据属性名取值， 可以配置 pageNum,pageSize,count,pageSizeZero,reasonable，不配置映射的用默认值， 默认值为pageNum=pageNum;pageSize=pageSize;count=countSql;reasonable=reasonable;pageSizeZero=pageSizeZero。</p></li><li><p>supportMethodsArguments：支持通过 Mapper 接口参数来传递分页参数，默认值false，分页插件会从查询方法的参数值中，自动根据上面 params 配置的字段中取值，查找到合适的值时就会自动分页。 使用方法可以参考测试代码中的 com.github.pagehelper.test.basic 包下的 ArgumentsMapTest 和 ArgumentsObjTest。</p></li><li><p>autoRuntimeDialect：默认值为 false。设置为 true 时，允许在运行时根据多数据源自动识别对应方言的分页 （不支持自动选择sqlserver2012，只能使用sqlserver），用法和注意事项参考下面的场景五。</p></li><li><p>closeConn：默认值为 true。当使用运行时动态数据源或没有设置 helperDialect 属性自动获取数据库类型时，会自动获取一个数据库连接， 通过该属性来设置是否关闭获取的这个连接，默认true关闭，设置为 false 后，不会关闭获取的连接，这个参数的设置要根据自己选择的数据源来决定。</p></li></ol><h5><a name='header-c123' class='md-header-anchor '></a>2.2.4.4 基本使用方法</h5><p>PageHelper的基本使用有6种，大家可以查看文档，最常用的有两种</p><h6><a name='header-c126' class='md-header-anchor '></a>2.2.4.4.1 RowBounds方式的调用（了解）</h6><pre class='md-fences mock-cm' style='display:block;position:relative'>List&lt;Country&gt; list = sqlSession.selectList(&quot;x.y.selectIf&quot;, null, new RowBounds(1, 10));</pre><p>使用这种调用方式时，你可以使用RowBounds参数进行分页，这种方式侵入性最小，我们可以看到，通过RowBounds方式调用只是使用了这个参数，并没有增加其他任何内容。</p><p>分页插件检测到使用了RowBounds参数时，就会对该查询进行物理分页。</p><p>关于这种方式的调用，有两个特殊的参数是针对 RowBounds 的，你可以参看上面的分页插件参数介绍</p><p>注：不只有命名空间方式可以用RowBounds，使用接口的时候也可以增加RowBounds参数，例如：</p><pre class='md-fences mock-cm' style='display:block;position:relative'>//这种情况下也会进行物理分页查询
List&lt;Country&gt; selectAll(RowBounds rowBounds);  </pre><p>注意： 由于默认情况下的 RowBounds 无法获取查询总数，分页插件提供了一个继承自 RowBounds 的 PageRowBounds，这个对象中增加了 total 属性，执行分页查询后，可以从该属性得到查询总数。</p><h6><a name='header-c140' class='md-header-anchor '></a>2.2.4.4.2 PageHelper.startPage 静态方法调用（重点）</h6><p>这种方式是我们要掌握的</p><p>在你需要进行分页的 MyBatis 查询方法前调用PageHelper.startPage 静态方法即可，紧跟在这个方法后的第一个MyBatis 查询方法会被进行分页。</p><pre class='md-fences mock-cm' style='display:block;position:relative'>//获取第1页，10条内容，默认查询总数count
PageHelper.startPage(1, 10);
//紧跟着的第一个select方法会被分页
List&lt;Country&gt; list = countryMapper.selectIf();</pre><h6><a name='header-c146' class='md-header-anchor '></a>2.2.4.4.3 PageInfo介绍</h6><p>以下是PageHelper自带的分页对象，基本能满足我们平时工作的分页需求，等会我们就直接使用它。</p><pre class='md-fences mock-cm' style='display:block;position:relative'>public class PageInfo&lt;T&gt; implements Serializable {
    private static final long serialVersionUID = 1L;
    //当前页
    private int pageNum;
    //每页的数量
    private int pageSize;
    //当前页的数量
    private int size;

    //由于startRow和endRow不常用，这里说个具体的用法
    //可以在页面中&quot;显示startRow到endRow 共size条数据&quot;

    //当前页面第一个元素在数据库中的行号
    private int startRow;
    //当前页面最后一个元素在数据库中的行号
    private int endRow;
    //总记录数
    private long total;
    //总页数
    private int pages;
    //结果集
    private List&lt;T&gt; list;

    //前一页
    private int prePage;
    //下一页
    private int nextPage;

    //是否为第一页
    private boolean isFirstPage = false;
    //是否为最后一页
    private boolean isLastPage = false;
    //是否有前一页
    private boolean hasPreviousPage = false;
    //是否有下一页
    private boolean hasNextPage = false;
    //导航页码数
    private int navigatePages;
    //所有导航页号
    private int[] navigatepageNums;
    //导航条上的第一页
    private int navigateFirstPage;
    //导航条上的最后一页
    private int navigateLastPage;
	//...略
}</pre><h5><a name='header-c150' class='md-header-anchor '></a>2.2.5 集成PageHelper</h5><h6><a name='header-c151' class='md-header-anchor '></a>2.2.5.1 工程中导入PageHelper依赖</h6><p>今天我们使用5.1.2的版本，分别在父工程和dao工程中导入以上包，父工程做版本的管理，子工程直接使用。</p><p>修改ssm-parent的pom.xml,在properties中加入版本</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;properties&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>//....略</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>//分页版本</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag">&lt;pagehelper.version&gt;</span>5.1.2<span class="cm-tag">&lt;/pagehelper.version&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/properties&gt;</span></span></pre></div></div></div></div></div></div></div></pre><p>修改ssm-parent的pom.xml，在dependencies中加入如下依赖</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;dependencies&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>//...略</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">&lt;!--分页插件--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag">&lt;dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tag">&lt;groupId&gt;</span>com.github.pagehelper<span class="cm-tag">&lt;/groupId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tag">&lt;artifactId&gt;</span>pagehelper<span class="cm-tag">&lt;/artifactId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tag">&lt;version&gt;</span>${pagehelper.version}<span class="cm-tag">&lt;/version&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag">&lt;/dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/dependencies&gt;</span></span></pre></div></div></div></div></div></div></div></pre><p>修改ssm-dao的pom.xml，在dependencies中加入如下依赖</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;dependencies&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>//...略</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">&lt;!--分页插件--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;groupId&gt;</span>com.github.pagehelper<span class="cm-tag">&lt;/groupId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;artifactId&gt;</span>pagehelper<span class="cm-tag">&lt;/artifactId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/dependencies&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h6><a name='header-c163' class='md-header-anchor '></a>2.2.5.2 项目中的配置</h6><p>在ssm-dao工程中，修改spring-mybatis.xml，找到SqlSessionFactoryBean结点的配置，修改如下：</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--SqlSessionFactoryBean--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;bean</span> <span class="cm-attribute">id</span>=<span class="cm-string">"sqlSessionFactoryBean"</span> <span class="cm-attribute">class</span>=<span class="cm-string">"org.mybatis.spring.SqlSessionFactoryBean"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">&lt;!--注入数据源--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;property</span> <span class="cm-attribute">name</span>=<span class="cm-string">"dataSource"</span> <span class="cm-attribute">ref</span>=<span class="cm-string">"dataSource"</span> <span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">&lt;!--集成分页插件--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;property</span> <span class="cm-attribute">name</span>=<span class="cm-string">"plugins"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;array&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;bean</span> <span class="cm-attribute">class</span>=<span class="cm-string">"com.github.pagehelper.PageInterceptor"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;property</span> <span class="cm-attribute">name</span>=<span class="cm-string">"properties"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;props&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!--数据库方言选中oracle--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;prop</span> <span class="cm-attribute">key</span>=<span class="cm-string">"helperDialect"</span><span class="cm-tag">&gt;</span>oracle<span class="cm-tag">&lt;/prop&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!--当该参数设置为 true 时，pageNum&lt;=0 时会查询第一页， pageNum&gt;pages（超过总数时），会查询最后一页--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;prop</span> <span class="cm-attribute">key</span>=<span class="cm-string">"reasonable"</span><span class="cm-tag">&gt;</span>true<span class="cm-tag">&lt;/prop&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/props&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/property&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/bean&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/array&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/property&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/bean&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h6><a name='header-c167' class='md-header-anchor '></a>2.2.5.3 修改Controller</h6><p>将返回类型修改成PageInfo，为了和之前的区分，我们创建一个新的方法pageHelperList。</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">* pageHelper分页查询</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">* @param model</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">* @return</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">*/</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">@RequestMapping</span>(<span class="cm-string">"/list"</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-variable-3">String</span> <span class="cm-def">list</span>(<span class="cm-meta">@RequestParam</span>(<span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-string">"page"</span>,<span class="cm-variable">required</span> <span class="cm-operator">=</span> <span class="cm-atom">false</span>,<span class="cm-variable">defaultValue</span> <span class="cm-operator">=</span> <span class="cm-string">"1"</span>) <span class="cm-variable-3">int</span> <span class="cm-variable">page</span>, <span class="cm-meta">@RequestParam</span>(<span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-string">"size"</span>,<span class="cm-variable">required</span> <span class="cm-operator">=</span> <span class="cm-atom">false</span>,<span class="cm-variable">defaultValue</span> <span class="cm-operator">=</span> <span class="cm-string">"10"</span>) <span class="cm-variable-3">int</span> <span class="cm-variable">size</span>, <span class="cm-variable">Model</span> <span class="cm-variable">model</span>){</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">PageInfo</span><span class="cm-operator">&lt;</span><span class="cm-variable">Product</span><span class="cm-operator">&gt;</span> <span class="cm-variable">pageInfo</span> <span class="cm-operator">=</span> <span class="cm-variable">productService</span>.<span class="cm-variable">pageHelperList</span>(<span class="cm-variable">page</span>,<span class="cm-variable">size</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">model</span>.<span class="cm-variable">addAttribute</span>(<span class="cm-string">"pageInfo"</span>,<span class="cm-variable">pageInfo</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">return</span> <span class="cm-string">"product-list"</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div></div></pre><h6><a name='header-c171' class='md-header-anchor '></a>2.2.5.4 修改Service</h6><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">/**</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">* 使用pageHelper实现分页查询</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">* @param page</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">* @param size</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">* @return</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">*/</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">@Override</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-variable">PageInfo</span><span class="cm-operator">&lt;</span><span class="cm-variable">Product</span><span class="cm-operator">&gt;</span> <span class="cm-def">pageHelperList</span>(<span class="cm-variable-3">int</span> <span class="cm-variable">page</span>, <span class="cm-variable-3">int</span> <span class="cm-variable">size</span>) {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//使用推荐方式 调用startPage</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">PageHelper</span>.<span class="cm-variable">startPage</span>(<span class="cm-variable">page</span>, <span class="cm-variable">size</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//集合查询</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">Product</span><span class="cm-operator">&gt;</span> <span class="cm-variable">list</span> <span class="cm-operator">=</span> <span class="cm-variable">productDao</span>.<span class="cm-variable">list</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">//创建pageInfo对象</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">PageInfo</span><span class="cm-operator">&lt;</span><span class="cm-variable">Product</span><span class="cm-operator">&gt;</span> <span class="cm-variable">pageInfo</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">PageInfo</span><span class="cm-operator">&lt;&gt;</span>(<span class="cm-variable">list</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">return</span> <span class="cm-variable">pageInfo</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div></div></pre><h6><a name='header-c173' class='md-header-anchor '></a>2.2.5.5 修改product-list.jsp页面</h6><p>首先要修改JSP中数据输出</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;tbody&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag">&lt;c:forEach</span> <span class="cm-attribute">items</span>=<span class="cm-string">"${pageInfo.list}"</span> <span class="cm-attribute">var</span>=<span class="cm-string">"product"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tag">&lt;tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span>//...略</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tag">&lt;/tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag">&lt;/c:forEach&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/tbody&gt;</span></span></pre></div></div></div></div></div></div></div></pre><p>找到分页参数，做以下修改，如下：</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"box-footer"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"pull-left"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"form-group form-inline"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  总共${pageInfo.pages} 页，${pageInfo.total} 条数据。 每页</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;select</span> <span class="cm-attribute">class</span>=<span class="cm-string">"form-control"</span> <span class="cm-attribute">onchange</span>=<span class="cm-string">"changePageSize(this)"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;option</span> <span class="cm-attribute">selected</span>=<span class="cm-string">"selected"</span><span class="cm-tag">&gt;</span>10<span class="cm-tag">&lt;/option&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;option</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-error">&lt;c:if test="${pageInfo.pageSize == 20}"&gt;selected</span><span class="cm-tag cm-error">&lt;/c:if&gt;</span> &gt;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab">    </span><span class="cm-tab">    </span> &nbsp; 20</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tab">    </span><span class="cm-tag cm-error">&lt;/option&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tab">    </span><span class="cm-tag cm-error">&lt;/select&gt;</span> 条</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tag">&lt;/div&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag cm-error">&lt;/div&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag">&lt;div</span> <span class="cm-attribute">class</span>=<span class="cm-string">"box-tools pull-right"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;ul</span> <span class="cm-attribute">class</span>=<span class="cm-string">"pagination"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"/product/list?page=1&amp;size=${pageInfo.pageSize}"</span> <span class="cm-attribute">aria-label</span>=<span class="cm-string">"Previous"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  首页</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"/product/list?page=${pageInfo.pageNum-1}&amp;size=${pageInfo.pageSize}"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  上一页</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;c:forEach</span> <span class="cm-attribute">begin</span>=<span class="cm-string">"1"</span> <span class="cm-attribute">end</span>=<span class="cm-string">"${pageInfo.pages}"</span> <span class="cm-attribute">var</span>=<span class="cm-string">"i"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;li&gt;&lt;a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"/product/list?page=${i}&amp;size=${pageInfo.pageSize}"</span><span class="cm-tag">&gt;</span>${i}<span class="cm-tag">&lt;/a&gt;&lt;/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/c:forEach&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"/product/list?page=${pageInfo.pageNum+1}&amp;size=${pageInfo.pageSize}"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  下一页</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"/product/list?page=${pageInfo.pages}&amp;size=${pageInfo.pageSize}"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-attribute">aria-label</span>=<span class="cm-string">"Next"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  尾页</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/li&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/ul&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag">&lt;/div&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag cm-error">&lt;/div&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h3><a name='header-c180' class='md-header-anchor '></a>第3章 Spring Security安全框架</h3><h4><a name='header-c181' class='md-header-anchor '></a>3.1 权限管理概述</h4><p>RBAC的模型：基于角色的访问控制模型。Role Based Access Controller</p><p><img src='img\图片02.png' alt='' /></p><h4><a name='header-c187' class='md-header-anchor '></a>3.2 Security框架基本介绍</h4><p>Spring Security 的前身是 Acegi Security ，是 Spring 项目组中用来提供安全认证服务的框架。(<a href='https://projects.spring.io/spring-security/' target='_blank' >https://projects.spring.io/spring-security/</a>)</p><p>Spring Security  为基于J2EE企业应用软件提供了全面安全服务。特别是使用领先的J2EE解决方案-Spring框架开发的企业软件项目。人们使用Spring Security有很多种原因，不过通常吸引他们的是在J2EE  Servlet规范或EJB规范中找不到典型企业应用场景的解决方案。</p><p>特别要指出的是他们不能再WAR 或 EAR 级别进行移植。这样，如果你更换服务器环境，就要，在新的目标环境进行大量的工作，对你的应用系统进行重新配 置安全。使用Spring Security  解决了这些问题，也为你提供很多有用的，完全可以指定的其他安全特性。</p><p>安全包括两个主要操作。</p><ul><li>“认证”，是为用户建立一个他所声明的主体。主题一般式指用户，设备或可以在你系 统中执行动作的其他系统。</li><li>“授权”指的是一个用户能否在你的应用中执行某个操作，在到达授权判断之前，身份的主题已经由 身份验证过程建立了。</li></ul><p>这些概念是通用的，不是Spring Security特有的。在身份验证层面，Spring  Security广泛支持各种身份验证模式，这些验证模型绝大多数都由第三方提供，或则正在开发的有关标准机构提供的，例如 Internet  Engineering Task Force.作为补充，Spring Security 也提供了自己的一套验证功能。</p><pre class='md-fences mock-cm' style='display:block;position:relative'>Spring Security 目前支持认证一体化如下认证技术：</pre><pre class='md-fences mock-cm' style='display:block;position:relative'>	HTTP BASIC authentication headers (一个基于IEFT  RFC 的标准)
	HTTP Digest authentication headers (一个基于IEFT  RFC 的标准)
	HTTP X.509 client certificate exchange  (一个基于IEFT RFC 的标准)
	LDAP (一个非常常见的跨平台认证需要做法，特别是在大环境)
	Form-based authentication (提供简单用户接口的需求)
	OpenID authentication
	Computer Associates Siteminder
	JA-SIG Central Authentication Service  (CAS，这是一个流行的开源单点登录系统)
	Transparent authentication context  propagation for Remote Method Invocation and HttpInvoker  (一个Spring远程调用协议)</pre><p>Maven依赖
	</p><pre class='md-fences mock-cm' style='display:block;position:relative'>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;
        &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt;
        &lt;version&gt;5.0.2.RELEASE&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</pre><h4><a name='header-c212' class='md-header-anchor '></a>3.3 SpringSecurity入门案例</h4><h5><a name='header-c213' class='md-header-anchor '></a>3.3.1 创建一个war包工程</h5><p>创建一个普通的war包工程，名字可以叫spring-security-demo，引入相关依赖</p><p>pom.xml</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">&lt;?xml</span> <span class="cm-meta">version="1.0" encoding="UTF-8"?&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;project</span> <span class="cm-attribute">xmlns</span>=<span class="cm-string">"http://maven.apache.org/POM/4.0.0"</span> <span class="cm-attribute">xmlns:xsi</span>=<span class="cm-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xsi:schemaLocation</span>=<span class="cm-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;modelVersion&gt;</span>4.0.0<span class="cm-tag">&lt;/modelVersion&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;groupId&gt;</span>com.itheima<span class="cm-tag">&lt;/groupId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;artifactId&gt;</span>spring-security-demo<span class="cm-tag">&lt;/artifactId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;version&gt;</span>1.0-SNAPSHOT<span class="cm-tag">&lt;/version&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;packaging&gt;</span>war<span class="cm-tag">&lt;/packaging&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;properties&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;spring.security.version&gt;</span>5.0.2.RELEASE<span class="cm-tag">&lt;/spring.security.version&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/properties&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;dependencies&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!--SpringSecurity--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;groupId&gt;</span>org.springframework.security<span class="cm-tag">&lt;/groupId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;artifactId&gt;</span>spring-security-web<span class="cm-tag">&lt;/artifactId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;version&gt;</span>${spring.security.version}<span class="cm-tag">&lt;/version&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;groupId&gt;</span>org.springframework.security<span class="cm-tag">&lt;/groupId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;artifactId&gt;</span>spring-security-config<span class="cm-tag">&lt;/artifactId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;version&gt;</span>${spring.security.version}<span class="cm-tag">&lt;/version&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!--ServletAPI--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;groupId&gt;</span>javax.servlet<span class="cm-tag">&lt;/groupId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;artifactId&gt;</span>javax.servlet-api<span class="cm-tag">&lt;/artifactId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;version&gt;</span>3.1.0<span class="cm-tag">&lt;/version&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;scope&gt;</span>provided<span class="cm-tag">&lt;/scope&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/dependencies&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;build&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;plugins&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;plugin&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;groupId&gt;</span>org.apache.tomcat.maven<span class="cm-tag">&lt;/groupId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;artifactId&gt;</span>tomcat7-maven-plugin<span class="cm-tag">&lt;/artifactId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;version&gt;</span>2.2<span class="cm-tag">&lt;/version&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;configuration&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!--</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">http://localhost:{8888}/{工程名字}</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">http://localhost:{port}/{path}</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;port&gt;</span>8888<span class="cm-tag">&lt;/port&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;path&gt;</span>/<span class="cm-tag">&lt;/path&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/configuration&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/plugin&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/plugins&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/build&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/project&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h5><a name='header-c219' class='md-header-anchor '></a>3.3.2 配置web.xml</h5><p>其中监听器主要用于加载配置文件，过滤器用于配置用户拦截，过滤器名字必须为 springSecurityFilterChain</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">&lt;?xml</span> <span class="cm-meta">version="1.0" encoding="UTF-8"?&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;web-app</span> <span class="cm-attribute">xmlns</span>=<span class="cm-string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xmlns:xsi</span>=<span class="cm-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xsi:schemaLocation</span>=<span class="cm-string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-attribute">version</span>=<span class="cm-string">"3.1"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;context-param&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;param-name&gt;</span>contextConfigLocation<span class="cm-tag">&lt;/param-name&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;param-value&gt;</span>classpath:spring-security.xml<span class="cm-tag">&lt;/param-value&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/context-param&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;listener&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="cm-tag">&lt;/listener-class&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/listener&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;filter&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;filter-name&gt;</span>springSecurityFilterChain<span class="cm-tag">&lt;/filter-name&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="cm-tag">&lt;/filter-class&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/filter&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;filter-mapping&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;filter-name&gt;</span>springSecurityFilterChain<span class="cm-tag">&lt;/filter-name&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;url-pattern&gt;</span>/*<span class="cm-tag">&lt;/url-pattern&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/filter-mapping&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/web-app&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h5><a name='header-c223' class='md-header-anchor '></a>3.3.3 配置spring-security.xml</h5><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">&lt;?xml</span> <span class="cm-meta">version="1.0" encoding="UTF-8"?&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;beans</span> <span class="cm-attribute">xmlns</span>=<span class="cm-string">"http://www.springframework.org/schema/beans"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xmlns:security</span>=<span class="cm-string">"http://www.springframework.org/schema/security"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xmlns:xsi</span>=<span class="cm-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xsi:schemaLocation</span>=<span class="cm-string">"http://www.springframework.org/schema/beans</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-string">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-string">http://www.springframework.org/schema/security</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-string">http://www.springframework.org/schema/security/spring-security.xsd"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">&lt;!--</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">auto-config:这个是一个自动配置过滤器(Filter)的属性</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">use-expressions:"是否使用spel表达式"，如果使用表达式：hasRole('ROLE_USER')</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:http</span> <span class="cm-attribute">auto-config</span>=<span class="cm-string">"true"</span> <span class="cm-attribute">use-expressions</span>=<span class="cm-string">"false"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!-- 配置拦截的请求地址，任何请求地址都必须有ROLE_USER的权限 --&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:intercept-url</span> <span class="cm-attribute">pattern</span>=<span class="cm-string">"/**"</span> <span class="cm-attribute">access</span>=<span class="cm-string">"ROLE_USER"</span><span class="cm-tag">&gt;&lt;/security:intercept-url&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/security:http&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">&lt;!--认证配置--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:authentication-manager&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:authentication-provider&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!--</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">配置账号密码，以及该账号的角色信息</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">其中{noop}表示加密的类型,noop则表示不使用任何加密方式</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">PasswordEncoderFactories中有所体现</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:user-service&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:user</span> <span class="cm-attribute">name</span>=<span class="cm-string">"admin"</span> <span class="cm-attribute">authorities</span>=<span class="cm-string">"ROLE_USER"</span> <span class="cm-attribute">password</span>=<span class="cm-string">"{noop}admin"</span><span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/security:user-service&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/security:authentication-provider&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/security:authentication-manager&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/beans&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h5><a name='header-c225' class='md-header-anchor '></a>3.3.4 测试</h5><p>当我们访问index.jsp页面时发现会弹出登录窗口，可能你会奇怪，我们没有建立下面的登录页面，为什么Spring Security会跳到上面的登录页面呢？这是我们设置http的auto-config=”true”时Spring Security自动为我们生成的。</p><h5><a name='header-c228' class='md-header-anchor '></a>3.3.5 使用自定义页面</h5><p>我们分别创建一个登录成功页面和登录失败页面以及登录页面，并且实现自定义登录成功、失败、登录等跳转。</p><h6><a name='header-c231' class='md-header-anchor '></a>3.3.5.1 登录页面 login.html</h6><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">&lt;!DOCTYPE html&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;html&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;head&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;meta</span> <span class="cm-attribute">charset</span>=<span class="cm-string">"UTF-8"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;title&gt;</span>Insert title here<span class="cm-tag">&lt;/title&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/head&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;body&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;form</span> <span class="cm-attribute">action</span>=<span class="cm-string">"login"</span> <span class="cm-attribute">method</span>=<span class="cm-string">"post"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;table&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;td&gt;</span>用户名：<span class="cm-tag">&lt;/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;td&gt;&lt;input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span> <span class="cm-attribute">name</span>=<span class="cm-string">"username"</span> <span class="cm-tag">/&gt;&lt;/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;td&gt;</span>密码：<span class="cm-tag">&lt;/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;td&gt;&lt;input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"password"</span> <span class="cm-attribute">name</span>=<span class="cm-string">"password"</span> <span class="cm-tag">/&gt;&lt;/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;td</span> <span class="cm-attribute">colspan</span>=<span class="cm-string">"2"</span> <span class="cm-attribute">align</span>=<span class="cm-string">"center"</span><span class="cm-tag">&gt;&lt;input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"submit"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"登录"</span> <span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"reset"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"重置"</span> <span class="cm-tag">/&gt;&lt;/td&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/tr&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/table&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/form&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/body&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/html&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h6><a name='header-c233' class='md-header-anchor '></a>3.3.5.2 登录成功页面 success.html</h6><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">&lt;!DOCTYPE html&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;html&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;head&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;meta</span> <span class="cm-attribute">charset</span>=<span class="cm-string">"UTF-8"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;title&gt;</span>Insert title here<span class="cm-tag">&lt;/title&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/head&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;body&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">success html<span class="cm-tag">&lt;br&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"logout"</span><span class="cm-tag">&gt;</span>退出<span class="cm-tag">&lt;/a&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/body&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/html&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h6><a name='header-c235' class='md-header-anchor '></a>3.3.5.3 登录失败页面 failer.html</h6><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">&lt;!DOCTYPE html&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;html&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;head&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;meta</span> <span class="cm-attribute">charset</span>=<span class="cm-string">"UTF-8"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;title&gt;</span>Insert title here<span class="cm-tag">&lt;/title&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/head&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;body&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>登录失败</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/body&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/html&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h6><a name='header-c237' class='md-header-anchor '></a>3.3.5.4 自定义页面跳转[配置spring-security.xml</h6><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">&lt;?xml</span> <span class="cm-meta">version="1.0" encoding="UTF-8"?&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;beans</span> <span class="cm-attribute">xmlns</span>=<span class="cm-string">"http://www.springframework.org/schema/beans"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xmlns:security</span>=<span class="cm-string">"http://www.springframework.org/schema/security"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xmlns:xsi</span>=<span class="cm-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xsi:schemaLocation</span>=<span class="cm-string">"http://www.springframework.org/schema/beans</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-string">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-string">http://www.springframework.org/schema/security</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-string">http://www.springframework.org/schema/security/spring-security.xsd"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">&lt;!--取消拦截的url地址--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:http</span> <span class="cm-attribute">pattern</span>=<span class="cm-string">"/login.html"</span> <span class="cm-attribute">security</span>=<span class="cm-string">"none"</span><span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:http</span> <span class="cm-attribute">pattern</span>=<span class="cm-string">"/failer.html"</span> <span class="cm-attribute">security</span>=<span class="cm-string">"none"</span><span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">&lt;!--</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">auto-config:这个是一个自动配置过滤器(Filter)的属性</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">use-expressions:"是否使用spel表达式"，如果使用表达式：hasRole('ROLE_USER')</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:http</span> <span class="cm-attribute">auto-config</span>=<span class="cm-string">"true"</span> <span class="cm-attribute">use-expressions</span>=<span class="cm-string">"false"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!-- 配置拦截的请求地址，任何请求地址都必须有ROLE_USER的权限 --&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:intercept-url</span> <span class="cm-attribute">pattern</span>=<span class="cm-string">"/**"</span> <span class="cm-attribute">access</span>=<span class="cm-string">"ROLE_USER"</span><span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span> &nbsp;  <span class="cm-tag">&lt;security:form-login</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-attribute">login-processing-url</span>=<span class="cm-string">"/login"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-attribute">login-page</span>=<span class="cm-string">"/login.html"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-attribute">default-target-url</span>=<span class="cm-string">"/success.html"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-attribute">always-use-default-target</span>=<span class="cm-string">"true"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-attribute">authentication-failure-url</span>=<span class="cm-string">"/failer.html"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!--关闭跨域安全请求--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:csrf</span> <span class="cm-attribute">disabled</span>=<span class="cm-string">"true"</span><span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!--</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-comment">退出配置</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-comment">logout-success-url:退出后跳转地址</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-comment">invalidate-session:让当前session失效</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-comment">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:logout</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-attribute">logout-success-url</span>=<span class="cm-string">"/login.html"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-attribute">invalidate-session</span>=<span class="cm-string">"true"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-attribute">logout-url</span>=<span class="cm-string">"/logout"</span><span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/security:http&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">&lt;!--认证配置--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:authentication-manager&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:authentication-provider&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!--</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">配置账号密码，以及该账号的角色信息</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">其中{noop}表示加密的类型,noop则表示不使用任何加密方式</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">PasswordEncoderFactories中有所体现</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:user-service&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:user</span> <span class="cm-attribute">name</span>=<span class="cm-string">"admin"</span> <span class="cm-attribute">authorities</span>=<span class="cm-string">"ROLE_USER"</span> <span class="cm-attribute">password</span>=<span class="cm-string">"{noop}admin"</span><span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/security:user-service&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/security:authentication-provider&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/security:authentication-manager&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/beans&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h3><a name='header-c239' class='md-header-anchor '></a>第4章 搭建用户的开发环境</h3><h4><a name='header-c240' class='md-header-anchor '></a>4.1 创建表结构</h4><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">--创建用户表</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">CREATE</span> <span class="cm-keyword">TABLE</span> sys_user(</span></pre><pre class=""><span style="padding-right: 0.1px;">  id number(<span class="cm-number">10</span>) PRIMARY KEY,</span></pre><pre class=""><span style="padding-right: 0.1px;">  username VARCHAR2(<span class="cm-number">50</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;">  email VARCHAR2(<span class="cm-number">50</span>) ,</span></pre><pre class=""><span style="padding-right: 0.1px;">  PASSWORD VARCHAR2(<span class="cm-number">80</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;">  phoneNum VARCHAR2(<span class="cm-number">20</span>),</span></pre><pre class=""><span style="padding-right: 0.1px;">  STATUS number(<span class="cm-number">1</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">);</span></pre></div></div></div></div></div></div></div></pre><h4><a name='header-c242' class='md-header-anchor '></a>4.2 创建SysUser</h4><p>在ssm-model中创建SysUser</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">SysUser</span> {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">private</span> <span class="cm-variable-3">Long</span> <span class="cm-variable">id</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">username</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">email</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">password</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">private</span> <span class="cm-variable-3">String</span> <span class="cm-variable">phoneNum</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">private</span> <span class="cm-variable-3">int</span> <span class="cm-variable">status</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-comment">//get...set...</span></span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div></div></pre><h4><a name='header-c246' class='md-header-anchor '></a>4.3 自定义认证程序</h4><h5><a name='header-c247' class='md-header-anchor '></a>4.3.1 导入依赖包</h5><p>在ssm-parent中引入依赖管理</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--统一管理版本--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;properties&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>//...略</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-tag">&lt;spring.security.version&gt;</span>5.0.2.RELEASE<span class="cm-tag">&lt;/spring.security.version&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/properties&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">//依赖管理</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;dependencies&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  //...略</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-comment">&lt;!--SpringSecurity--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tag">&lt;dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;groupId&gt;</span>org.springframework.security<span class="cm-tag">&lt;/groupId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;artifactId&gt;</span>spring-security-web<span class="cm-tag">&lt;/artifactId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;version&gt;</span>${spring.security.version}<span class="cm-tag">&lt;/version&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tag">&lt;/dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tag">&lt;dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;groupId&gt;</span>org.springframework.security<span class="cm-tag">&lt;/groupId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;artifactId&gt;</span>spring-security-config<span class="cm-tag">&lt;/artifactId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;version&gt;</span>${spring.security.version}<span class="cm-tag">&lt;/version&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tag">&lt;/dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/dependencies&gt;</span></span></pre></div></div></div></div></div></div></div></pre><p>在ssm-service中引入依赖</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--引入SpringSecurity--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;groupId&gt;</span>org.springframework.security<span class="cm-tag">&lt;/groupId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;artifactId&gt;</span>spring-security-web<span class="cm-tag">&lt;/artifactId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;dependency&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;groupId&gt;</span>org.springframework.security<span class="cm-tag">&lt;/groupId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;artifactId&gt;</span>spring-security-config<span class="cm-tag">&lt;/artifactId&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/dependency&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h5><a name='header-c254' class='md-header-anchor '></a>4.3.2 自定义认证类</h5><p>在ssm-service中创建UserService接口，让该接口继承UserDetailsService</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">interface</span> <span class="cm-def">UserService</span> <span class="cm-keyword">extends</span> <span class="cm-variable">UserDetailsService</span> {</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div></div></pre><p>创建UserServiceImpl实现UserService，同时实现loadUserByUsername方法，在该方法中写登录认证程序</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">@Service</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">UserServiceImpl</span> <span class="cm-keyword">implements</span> <span class="cm-variable">UserService</span> {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-meta">@Override</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">public</span> <span class="cm-variable">UserDetails</span> <span class="cm-variable">loadUserByUsername</span>(<span class="cm-variable-3">String</span> <span class="cm-variable">username</span>) <span class="cm-keyword">throws</span> <span class="cm-variable">UsernameNotFoundException</span> {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 先设置假的权限</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">GrantedAuthority</span><span class="cm-operator">&gt;</span> <span class="cm-variable">authorities</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;&gt;</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 传入角色</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">authorities</span>.<span class="cm-variable">add</span>(<span class="cm-keyword">new</span> <span class="cm-variable">SimpleGrantedAuthority</span>(<span class="cm-string">"ROLE_USER"</span>));</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 创建用户</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">User</span> <span class="cm-variable">user</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">User</span>(<span class="cm-variable">username</span>, <span class="cm-string">"{noop}admin"</span>, <span class="cm-variable">authorities</span>) ;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">return</span> <span class="cm-variable">user</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div></div></pre><h5><a name='header-c261' class='md-header-anchor '></a>4.3.3 继承SpringSecurity</h5><h6><a name='header-c262' class='md-header-anchor '></a>4.3.3.1 过滤器配置</h6><p>在ssm-web中修改web.xml，加入springsecurity过滤器</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--SpringSecurity过滤器--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;filter&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tag">&lt;filter-name&gt;</span>springSecurityFilterChain<span class="cm-tag">&lt;/filter-name&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tag">&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="cm-tag">&lt;/filter-class&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/filter&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;filter-mapping&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tag">&lt;filter-name&gt;</span>springSecurityFilterChain<span class="cm-tag">&lt;/filter-name&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-tag">&lt;url-pattern&gt;</span>/*<span class="cm-tag">&lt;/url-pattern&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/filter-mapping&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h6><a name='header-c266' class='md-header-anchor '></a>4.3.3.2 配置spring-security.xml</h6><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">&lt;?xml</span> <span class="cm-meta">version="1.0" encoding="UTF-8"?&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;beans</span> <span class="cm-attribute">xmlns</span>=<span class="cm-string">"http://www.springframework.org/schema/beans"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xmlns:security</span>=<span class="cm-string">"http://www.springframework.org/schema/security"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xmlns:xsi</span>=<span class="cm-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-attribute">xsi:schemaLocation</span>=<span class="cm-string">"http://www.springframework.org/schema/beans</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-string">http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-string">http://www.springframework.org/schema/security</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-string">http://www.springframework.org/schema/security/spring-security.xsd"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">&lt;!--放行的地址--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:http</span> <span class="cm-attribute">pattern</span>=<span class="cm-string">"/*.jsp"</span> <span class="cm-attribute">security</span>=<span class="cm-string">"none"</span> <span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:http</span> <span class="cm-attribute">pattern</span>=<span class="cm-string">"/css/**"</span> <span class="cm-attribute">security</span>=<span class="cm-string">"none"</span> <span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:http</span> <span class="cm-attribute">pattern</span>=<span class="cm-string">"/img/**"</span> <span class="cm-attribute">security</span>=<span class="cm-string">"none"</span> <span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:http</span> <span class="cm-attribute">pattern</span>=<span class="cm-string">"/plugins/**"</span> <span class="cm-attribute">security</span>=<span class="cm-string">"none"</span> <span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">&lt;!--</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">配置要拦截的URL</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">auto-config:自动配置[自动配置那10个过滤器]</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">use-expressions：是否使用SPEL表达式,access="hasRole('ROLE_USER')"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:http</span> <span class="cm-attribute">auto-config</span>=<span class="cm-string">"true"</span> <span class="cm-attribute">use-expressions</span>=<span class="cm-string">"false"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!--</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">pattern="/**":拦截所有请求</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-comment">access="ROLE_USER":表示允许ROLE_USER角色访问上面被拦截的地址</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:intercept-url</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-attribute">pattern</span>=<span class="cm-string">"/**"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-attribute">access</span>=<span class="cm-string">"ROLE_USER"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:form-login</span> <span class="cm-attribute">login-page</span>=<span class="cm-string">"/login.jsp"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-attribute">default-target-url</span>=<span class="cm-string">"/pages/main.jsp"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-attribute">always-use-default-target</span>=<span class="cm-string">"true"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-attribute">authentication-failure-forward-url</span>=<span class="cm-string">"/failer.jsp"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-attribute">login-processing-url</span>=<span class="cm-string">"/login"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">&lt;!--关闭csrf安全策略--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:csrf</span> <span class="cm-attribute">disabled</span>=<span class="cm-string">"true"</span> <span class="cm-tag">/&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/security:http&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">&lt;!--授权配置--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;security:authentication-manager&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;security:authentication-provider</span> <span class="cm-attribute">user-service-ref</span>=<span class="cm-string">"userServiceImpl"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-tag">&lt;/security:authentication-provider&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-tag">&lt;/security:authentication-manager&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/beans&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h6><a name='header-c268' class='md-header-anchor '></a>4.3.3.3 引入springsecurity配置</h6><p>修改springmvc.xml，添加导入spring-security.xml</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment">&lt;!--引入SpringSecurity配置--&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;import</span> <span class="cm-attribute">resource</span>=<span class="cm-string">"spring-security.xml"</span> <span class="cm-tag">/&gt;</span></span></pre></div></div></div></div></div></div></div></pre><h6><a name='header-c272' class='md-header-anchor '></a>4.3.3.4 修改登录地址</h6><p>修改login.jsp，将action地址改成/login</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;form</span> <span class="cm-attribute">action</span>=<span class="cm-string">"${pageContext.request.contextPath}/login"</span> <span class="cm-attribute">method</span>=<span class="cm-string">"post"</span><span class="cm-tag">&gt;</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>//...略</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tag">&lt;/form&gt;</span></span></pre></div></div></div></div></div></div></div></pre><p>至此，可以实现登录校验了。</p><h4><a name='header-c278' class='md-header-anchor '></a>4.4 数据库校验</h4><p>可以将上述功能写死的账号密码从数据库获取，只需要修改UserServiceImpl，调用Dao从数据库查询即可。</p><h5><a name='header-c281' class='md-header-anchor '></a>4.4.1 Dao实现数据库查询</h5><p>创建UserDao</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">interface</span> <span class="cm-def">UserDao</span> {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment">/***</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-comment">* 查询用户信息</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-comment">* @param name</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-comment">* @return</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-comment">*/</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-meta">@Select</span>(<span class="cm-string">"select * from sys_user where username=#{username}"</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">SysUser</span> <span class="cm-variable">getByUserName</span>(<span class="cm-variable-3">String</span> <span class="cm-variable">name</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div></div></pre><h5><a name='header-c285' class='md-header-anchor '></a>4.4.2调用Dao实现数据库查询账号信息</h5><p>创建UserServiceImpl实现UserService，同时实现loadUserByUsername方法，在该方法中写登录认证程序</p><pre class="md-fences"><div class="code-tooltip md-tooltip-hide" align="right"></div> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px;"></div><div class="CodeMirror-vscrollbar"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-code"><pre class=""><span style="padding-right: 0.1px;"><span class="cm-meta">@Service</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">public</span> <span class="cm-keyword">class</span> <span class="cm-def">UserServiceImpl</span> <span class="cm-keyword">implements</span> <span class="cm-variable">UserService</span> {</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-meta">@Autowired</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">private</span> <span class="cm-variable">UserDao</span> <span class="cm-variable">userDao</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-meta">@Override</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">public</span> <span class="cm-variable">UserDetails</span> <span class="cm-variable">loadUserByUsername</span>(<span class="cm-variable-3">String</span> <span class="cm-variable">username</span>) <span class="cm-keyword">throws</span> <span class="cm-variable">UsernameNotFoundException</span> {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 先设置假的权限</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">List</span><span class="cm-operator">&lt;</span><span class="cm-variable">GrantedAuthority</span><span class="cm-operator">&gt;</span> <span class="cm-variable">authorities</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">ArrayList</span><span class="cm-operator">&lt;&gt;</span>();</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 传入角色</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">authorities</span>.<span class="cm-variable">add</span>(<span class="cm-keyword">new</span> <span class="cm-variable">SimpleGrantedAuthority</span>(<span class="cm-string">"ROLE_USER"</span>));</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">//通过账号查询用户信息</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">SysUser</span> <span class="cm-variable">sysUser</span> <span class="cm-operator">=</span> <span class="cm-variable">userDao</span>.<span class="cm-variable">getByUserName</span>(<span class="cm-variable">username</span>);</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-comment">// 创建用户</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">User</span> <span class="cm-variable">user</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">User</span>(<span class="cm-variable">username</span>, <span class="cm-string">"{noop}"</span><span class="cm-operator">+</span><span class="cm-variable">sysUser</span>.<span class="cm-variable">getPassword</span>(), <span class="cm-variable">authorities</span>) ;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">return</span> <span class="cm-variable">user</span>;</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div></div></pre><p></p><p></p></div>
</body>
</html>